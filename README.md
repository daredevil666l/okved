# Документация по программе Notice

## 1. Обзор программы

**Notice** – это Python-приложение для поиска организаций по коду ОКВЭД через API Checko. Программа позволяет автоматически собирать данные о компаниях и экспортировать их в Excel-файл.

### Основные возможности:
- Поиск организаций по ОКВЭД-коду
- Автоматическая пагинация результатов до заданного лимита
- Автоматическая ротация API-ключей для продолжения работы при достижении лимитов
- Дедупликация результатов для исключения повторяющихся данных
- Получение детальной информации по каждой найденной организации
- Сбор контактных данных (телефоны, email) и юридических адресов
- Экспорт результатов в Excel с форматированием
- Современный интерфейс с анимациями и индикаторами прогресса

## 2. Требования и установка

### Системные требования:
- Python 3.6 или выше
- Доступ в интернет для работы с API Checko
- API-ключи Checko

### Необходимые библиотеки:
- requests - для HTTP-запросов к API
- tkinter - для графического интерфейса
- openpyxl - для экспорта данных в Excel

### Установка зависимостей:
```bash
pip install requests openpyxl
```
*Примечание: tkinter обычно включён в стандартную библиотеку Python.*

## 3. Запуск программы

Для запуска программы выполните:
```bash
python notice.py
```

## 4. Интерфейс программы

![Интерфейс программы Notice](https://i.ibb.co/ZpYgLh6h/image.png - название программы "NOTICE" на синем фоне
2. **Панель API-ключей** - информация о загруженных ключах
3. **Панель параметров поиска**:
   - Поле для ввода кода ОКВЭД
   - Поле для указания максимального количества организаций
   - Флажок "Только активные организации"
   - Кнопки "Начать поиск" и "Остановить"
4. **Таблица результатов** с колонками:
   - ИНН
   - Наименование
   - Адрес
   - Email
   - Телефон
5. **Кнопка экспорта** в формате Excel
6. **Строка статуса и индикатор прогресса** для отображения состояния процесса
7. **Анимированный индикатор** для визуализации активного процесса

## 5. Использование программы

### Поиск организаций:

1. В поле "Код ОКВЭД" введите интересующий ОКВЭД (например, "62.01" для компаний, занимающихся разработкой ПО)
2. В поле "Макс. количество" укажите максимальное число компаний для поиска (по умолчанию 1000)
3. При необходимости снимите флажок "Только активные организации"
4. Нажмите кнопку "Начать поиск"
5. Дождитесь завершения поиска и получения данных
6. Для преждевременной остановки нажмите кнопку "Остановить"

### Экспорт результатов:

1. После завершения поиска нажмите кнопку "Экспорт в Excel"
2. Выбранные данные будут сохранены в Excel-файл с названием вида `notice_export_YYYYMMDD_HHMMSS.xlsx`
3. Файл будет создан в текущей директории программы

## 6. Работа с API-ключами

Программа использует предустановленный список API-ключей Checko:

```python
self.api_keys = [
    'MKXMk0GLaUN48g63','8zg1SLEpQPe7DCDH','K2TX2471T12E4qMP',
    '8L1FghahT7pWWv8H','WgSDVbbjfakK4Pj2','Nx6JYT5tXlCDrT89',
    'yIvRc7Z29tZ2pvmw','o7rA5pXvQvUBmkCT','UYtyJAYCFuCIitpu',
    'ijo2nJdF2ZVMuyY8','bfcsAIOe0dS9bbeK','HZa0jsZSxUZI6x44',
    'wros2k7udZCInXbh','DoBA8V5nSXidszTO','iBtUfMDQH3klPsdx',
    'wWs0zpbtMAxAZoV1','TFOp6wBsqJxQD6sW','nvmRggGoc6av1XFn',
    'gC7Vinvt74myvtB2','xmHSJECg4PnW35XR'
]
```

### Механизм ротации ключей:

1. При достижении лимита запросов или возникновении ошибки программа автоматически переключается на следующий ключ
2. Если все ключи исчерпаны или недействительны, поиск прекращается с соответствующим сообщением
3. Система ротации позволяет максимально эффективно использовать доступные API-ключи

## 7. Особенности работы программы

### Дедупликация результатов

Программа автоматически отслеживает уже найденные организации по их ИНН и исключает дубликаты, что позволяет:
1. Экономить API-запросы на получение детальной информации
2. Исключить повторы в итоговой выборке
3. Получать только уникальные результаты при пагинации

### Обработка пагинации

API Checko возвращает результаты постранично, по 100 записей на странице. Программа:
1. Автоматически обходит все страницы результатов до достижения указанного лимита
2. Останавливается, если на 3 страницах подряд не найдено новых организаций
3. Показывает прогресс обработки и общее количество найденных организаций

### Получение детальной информации

Для каждой найденной организации программа запрашивает детальную информацию:
1. Отправляет запрос к API Checko по ИНН компании
2. Извлекает необходимые данные (наименование, адрес, контакты)
3. Отображает полученные данные в таблице и сохраняет для экспорта

## 8. Экспорт в Excel

Экспортированный файл содержит:
1. Таблицу с колонками: ИНН, Наименование, Адрес, Email, Телефон
2. Форматирование: жирные заголовки, оптимальная ширина столбцов, границы ячеек
3. Имя файла включает дату и время создания для удобной сортировки

## 9. Советы по эксплуатации

### Оптимизация поиска:
- Указывайте более точные коды ОКВЭД для снижения количества результатов
- При большом количестве результатов используйте фильтр "Только активные организации"
- При необходимости остановите поиск и уточните параметры

### Увеличение лимитов API:
1. **Получение дополнительных API-ключей**:
   - Зарегистрируйте дополнительные аккаунты на [checko.ru](https://checko.ru/)
   - Получите API-ключи в разделе настроек аккаунта
   - Добавьте полученные ключи в код программы

2. **Оптимизация запросов**:
   - Используйте более точные коды ОКВЭД
   - Устанавливайте разумные лимиты на количество организаций
   - Запускайте поиск в нерабочее время, когда лимиты могут быть восстановлены

## 10. Компиляция программы в EXE-файл

Для создания автономного исполняемого файла можно использовать PyInstaller:

1. **Установка PyInstaller**:
```bash
pip install pyinstaller
```

2. **Создание EXE-файла**:
```bash
pyinstaller --onefile --windowed notice.py
```

3. **Параметры компиляции**:
   - `--onefile` - создать один EXE-файл вместо директории
   - `--windowed` - запуск без консольного окна
   - `--icon=icon.ico` - добавление иконки (опционально)

## 11. Структура кода программы

Программа организована в следующие основные классы:

1. **APIKeyManager** - класс для управления API-ключами с автоматической ротацией
2. **NoticeApp** - основной класс приложения, включающий интерфейс и бизнес-логику
3. **make_request_with_key_rotation** - функция для выполнения запросов с автоматической сменой ключей
4. **search_companies** - функция поиска организаций с пагинацией и дедупликацией
5. **get_company_details** - функция получения детальной информации об организации
6. **export_to_xlsx** - функция экспорта данных в Excel

Каждый метод имеет документацию, объясняющую его назначение и принцип работы.

## 12. Заключение

Программа Notice предоставляет удобный интерфейс для поиска организаций по коду ОКВЭД и сбора их контактных данных с использованием API Checko. Автоматическая ротация ключей и дедупликация результатов обеспечивают эффективное использование API и получение максимально полной информации.

---
Answer from Perplexity: pplx.ai/share
